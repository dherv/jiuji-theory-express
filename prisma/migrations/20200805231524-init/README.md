# Migration `20200805231524-init`

This migration has been generated by dherv at 8/6/2020, 8:15:24 AM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE `jiuji-theory`.`User` (
`id` int NOT NULL  AUTO_INCREMENT,
`email` varchar(191) NOT NULL ,
`name` varchar(191) NOT NULL ,
`belt` ENUM('WHITE', 'BLUE', 'PURPLE', 'BROWN', 'BLACK') NOT NULL DEFAULT 'WHITE',
`locationId` int NOT NULL ,
`started` datetime(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
`createdAt` datetime(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
PRIMARY KEY (`id`)
) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE TABLE `jiuji-theory`.`Location` (
`id` int NOT NULL  AUTO_INCREMENT,
`createdAt` datetime(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
`updatedAt` datetime(3) NOT NULL ,
PRIMARY KEY (`id`)
) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE TABLE `jiuji-theory`.`Teacher` (
`id` int NOT NULL  AUTO_INCREMENT,
`name` varchar(191) NOT NULL ,
`clubId` int NOT NULL ,
`createdAt` datetime(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
`updatedAt` datetime(3) NOT NULL ,
PRIMARY KEY (`id`)
) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE TABLE `jiuji-theory`.`Club` (
`id` int NOT NULL  AUTO_INCREMENT,
`userId` int NOT NULL ,
`locationId` int NOT NULL ,
`createdAt` datetime(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
`updatedAt` datetime(3) NOT NULL ,
PRIMARY KEY (`id`)
) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE TABLE `jiuji-theory`.`Technique` (
`id` int NOT NULL  AUTO_INCREMENT,
`name` varchar(191) NOT NULL ,
`teacherId` int NOT NULL ,
`positionId` int NOT NULL ,
`submissionId` int NOT NULL ,
`guardId` int NOT NULL ,
`createdAt` datetime(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
`updatedAt` datetime(3) NOT NULL ,
PRIMARY KEY (`id`)
) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE TABLE `jiuji-theory`.`TechniqueStep` (
`id` int NOT NULL  AUTO_INCREMENT,
`text` varchar(191) NOT NULL ,
`order` int NOT NULL ,
`techniqueId` int NOT NULL ,
`userId` int NOT NULL ,
`createdAt` datetime(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
`updatedAt` datetime(3) NOT NULL ,
PRIMARY KEY (`id`)
) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE TABLE `jiuji-theory`.`Position` (
`id` int NOT NULL  AUTO_INCREMENT,
`name` ENUM('OFFENSIVE', 'DEFENSIVE') NOT NULL DEFAULT 'OFFENSIVE',
PRIMARY KEY (`id`)
) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE TABLE `jiuji-theory`.`Submission` (
`id` int NOT NULL  AUTO_INCREMENT,
`name` varchar(191) NOT NULL ,
`userId` int NOT NULL ,
`default` boolean NOT NULL ,
`createdAt` datetime(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
`updatedAt` datetime(3) NOT NULL ,
PRIMARY KEY (`id`)
) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE TABLE `jiuji-theory`.`Guard` (
`id` int NOT NULL  AUTO_INCREMENT,
`name` varchar(191) NOT NULL ,
`userId` int NOT NULL ,
`default` boolean NOT NULL ,
`createdAt` datetime(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
`updatedAt` datetime(3) NOT NULL ,
PRIMARY KEY (`id`)
) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE TABLE `jiuji-theory`.`Video` (
`id` int NOT NULL  AUTO_INCREMENT,
`name` varchar(191) NOT NULL ,
`channelId` varchar(191) NOT NULL ,
`description` varchar(191) NOT NULL ,
`userId` int NOT NULL ,
`createdAt` datetime(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
`updatedAt` datetime(3) NOT NULL ,
PRIMARY KEY (`id`)
) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE TABLE `jiuji-theory`.`_TechniqueToVideo` (
`A` int NOT NULL ,
`B` int NOT NULL 
) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE UNIQUE INDEX `User.email_unique` ON `jiuji-theory`.`User`(`email`)

CREATE UNIQUE INDEX `_TechniqueToVideo_AB_unique` ON `jiuji-theory`.`_TechniqueToVideo`(`A`,`B`)

CREATE  INDEX `_TechniqueToVideo_B_index` ON `jiuji-theory`.`_TechniqueToVideo`(`B`)

ALTER TABLE `jiuji-theory`.`User` ADD FOREIGN KEY (`locationId`) REFERENCES `jiuji-theory`.`Location`(`id`) ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE `jiuji-theory`.`Teacher` ADD FOREIGN KEY (`clubId`) REFERENCES `jiuji-theory`.`Club`(`id`) ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE `jiuji-theory`.`Club` ADD FOREIGN KEY (`userId`) REFERENCES `jiuji-theory`.`User`(`id`) ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE `jiuji-theory`.`Club` ADD FOREIGN KEY (`locationId`) REFERENCES `jiuji-theory`.`Location`(`id`) ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE `jiuji-theory`.`Technique` ADD FOREIGN KEY (`teacherId`) REFERENCES `jiuji-theory`.`Teacher`(`id`) ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE `jiuji-theory`.`Technique` ADD FOREIGN KEY (`positionId`) REFERENCES `jiuji-theory`.`Position`(`id`) ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE `jiuji-theory`.`Technique` ADD FOREIGN KEY (`submissionId`) REFERENCES `jiuji-theory`.`Submission`(`id`) ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE `jiuji-theory`.`Technique` ADD FOREIGN KEY (`guardId`) REFERENCES `jiuji-theory`.`Guard`(`id`) ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE `jiuji-theory`.`TechniqueStep` ADD FOREIGN KEY (`techniqueId`) REFERENCES `jiuji-theory`.`Technique`(`id`) ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE `jiuji-theory`.`TechniqueStep` ADD FOREIGN KEY (`userId`) REFERENCES `jiuji-theory`.`User`(`id`) ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE `jiuji-theory`.`Submission` ADD FOREIGN KEY (`userId`) REFERENCES `jiuji-theory`.`User`(`id`) ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE `jiuji-theory`.`Guard` ADD FOREIGN KEY (`userId`) REFERENCES `jiuji-theory`.`User`(`id`) ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE `jiuji-theory`.`Video` ADD FOREIGN KEY (`userId`) REFERENCES `jiuji-theory`.`User`(`id`) ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE `jiuji-theory`.`_TechniqueToVideo` ADD FOREIGN KEY (`A`) REFERENCES `jiuji-theory`.`Technique`(`id`) ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE `jiuji-theory`.`_TechniqueToVideo` ADD FOREIGN KEY (`B`) REFERENCES `jiuji-theory`.`Video`(`id`) ON DELETE CASCADE ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration ..20200805231524-init
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,123 @@
+datasource mysql {
+  provider = "mysql"
+  url = "***"
+}
+
+generator client {
+  provider = "prisma-client-js"
+}
+
+model User {
+  id Int @default(autoincrement()) @id
+  email String @unique
+  name String
+  belt Belt @default(WHITE)
+  location Location @relation(fields: [locationId], references: [id])
+  locationId Int
+  started DateTime @default(now())
+  createdAt DateTime @default(now())
+}
+
+model Location {
+    id Int @default(autoincrement()) @id
+    createdAt DateTime @default(now())
+    updatedAt DateTime @updatedAt
+}
+
+model Teacher {
+    id Int @default(autoincrement()) @id
+    name String
+    club Club @relation(fields: [clubId], references: [id])
+    clubId Int
+    createdAt DateTime @default(now())
+    updatedAt DateTime @updatedAt
+}
+
+model Club {
+    id Int  @default(autoincrement()) @idÂ 
+    user User @relation(fields: [userId], references: [id])
+    userId Int
+    location Location @relation(fields: [locationId], references: [id])
+    locationId Int
+    teachers Teacher[]
+    createdAt DateTime @default(now())
+    updatedAt DateTime @updatedAt
+}
+
+model Technique {
+    id Int @default(autoincrement()) @id
+    name String
+    teacher Teacher @relation(fields: [teacherId], references: [id])
+    teacherId Int
+    position Position @relation(fields: [positionId], references: [id])
+    positionId Int
+    submision Submission @relation(fields: [submissionId], references: [id])
+    submissionId  Int
+    guard Guard @relation(fields: [guardId], references: [id])
+    guardId Int
+    video Video[] @relation(references: [id])
+    createdAt DateTime @default(now())
+    updatedAt DateTime @updatedAt
+}
+
+model TechniqueStep {
+    id Int @default(autoincrement()) @id
+    text String
+    order Int
+    technique Technique @relation(fields: [techniqueId], references: [id])
+    techniqueId Int
+    user User @relation(fields: [userId], references: [id])
+    userId Int
+    createdAt DateTime @default(now())
+    updatedAt DateTime @updatedAt
+}
+
+enum PositionType {
+  OFFENSIVE
+  DEFENSIVE
+}
+
+model Position {
+    id Int @default(autoincrement()) @id
+    name PositionType @default(OFFENSIVE)
+}
+
+model Submission {
+    id Int @default(autoincrement()) @id
+    name String
+    user User @relation(fields: [userId], references: [id])
+    userId Int
+    default Boolean
+    createdAt DateTime @default(now())
+    updatedAt DateTime @updatedAt
+}
+
+model Guard {
+    id Int @default(autoincrement()) @id
+    name String
+    user User @relation(fields: [userId], references: [id])
+    userId Int
+    default Boolean
+    createdAt DateTime @default(now())
+    updatedAt DateTime @updatedAt
+}
+
+model Video {
+  id Int @default(autoincrement()) @id
+  name String
+  channelId String
+  description String
+  user User @relation(fields: [userId], references: [id])
+  userId Int
+  technique Technique[] @relation(references: [id])
+  createdAt DateTime @default(now())
+  updatedAt DateTime @updatedAt
+}
+
+enum Belt {
+  WHITE
+  BLUE
+  PURPLE
+  BROWN
+  BLACK
+}
```


